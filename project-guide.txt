
| Task ID | Priority | Module                      | Title (Generic & Safe)                              | Detailed Action (Copy-Paste Ready)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Test / Expected Outcome                                                                                                                                                                   | Acceptance Criteria                                                                                                          | Assigned To       | Start Date | Due Date   | Status       |

| T01     | P0       | Webhook Security            | Secure all public webhook entry points              | Implement HMAC-SHA256 signature verification on VPS. All external systems must POST to `/webhook/entry` with `X-Signature` header. Server validates signature using shared secret (stored in vault). On success → forward sanitized payload to internal trigger endpoint with new `internal_event_id`. Add rate limiting (100 req/min per IP) and block list.                                                                                             | Send unsigned request → 401. Send valid signed request → 200 + internal flow triggered once. Replay same payload → rejected. | All external triggers require valid signature. No public unsigned URLs remain.                                                      | Backend Lead       |            |            | Not Started  |
| T02     | P0       | Authentication & Secrets    | Centralise and harden all third-party credentials  | Move every integration credential (SMS, Email, Storage, Sheets, Payment, Slack) into vault-managed ENV vars only. Replace any personal/test accounts. Use service-account JSON for Google, Messaging Service SID for SMS, verified domain + SPF/DKIM for email. Never hard-code or expose in code.                                                                                                                                                     | Run integration tests → all external calls succeed with vault credentials. Personal accounts no longer used.                 | Zero personal or test credentials in production. All auth works end-to-end.                                                          | Integration Eng    |            |            | Not Started  |
| T03     | P0       | Payload Validation          | Enforce strict schema validation on every entry     | Add middleware `/middleware/validatePayload.js` that checks required fields, data types, formats (E.164 phones, RFC emails, numeric amounts, presence of `internal_event_id`). On failure → return 400 + log + admin alert. Success → enrich payload with normalised fields and pass downstream.                                                                                                                                                           | Invalid/missing fields → 400 + admin alert. Valid payload → proceeds with normalised data.                                       | Every single incoming event is validated before any side effect occurs.                                                             | Backend Lead       |            |            | Not Started  |
| T04     | P0       | Deduplication & Idempotency | Prevent duplicate processing                        | Use MongoDB collection `processed_events` with unique index on `internal_event_id` + TTL 72h. At start of every flow: check existence → if found, return 200 early. If not, insert and continue.                                                                                                                                                                                                                                                                    | Send same signed payload twice within 72h → second request processed only once.                                                 | No duplicate actions (emails, SMS, payments, database rows) under any replay scenario.                                               | Backend Lead       |            |            | Not Started  |
| T05     | P0       | Empty/Broken Actions        | Remove or fix all no-op steps                       | Audit all flows in n8n and code: any step with empty action or unmapped required fields must be corrected or deleted. Example: SMS step must have valid `to` and `body`, Slack step must have channel + text.                                                                                                                                                                                                                                    | Trigger flow → every step executes successfully, no “empty action” errors in logs.                                               | Zero steps with missing configuration in production.                                                                                | Automation Eng     |            |            | Not Started  |
| T06     | P0       | Sensitive Operations        | Add server-side verification gate for high-risk actions | Any action that causes money movement, user credit, or privileged status change must call a dedicated VPS verification endpoint first (e.g., `/verify/entitlement`). Only if endpoint returns `{ allowed: true }` may the action proceed. Add audit log entry with `internal_event_id`, user_id, amount, verifier = "system".                                                                                                                                    | Fake/malicious payload → blocked before action. Valid + verified payload → action executed + audit entry created.              | High-risk actions impossible without explicit server-side approval.                                                                 | Backend Lead       |            |            | Not Started  |
| T07     | P0       | Error Handling & Observability | Global error catching, retry, and admin alerts      | Wrap every external call in retry (3× exponential backoff). On final failure → log full context + POST to `/alert/admin` (Slack + email). Add correlation ID to every log line. Centralise logs via Winston + daily rotation.                                                                                                                                                                                                                      | Force transient failure → retries occur → final failure triggers admin alert with full payload + stack.                       | No silent failures. Admins notified within 60s of any critical error.                                                               | DevOps / Backend   |            |            | Not Started  |
| T08     | P1       | Flow Architecture           | Split monolithic flows into single-responsibility workflows | Break current overloaded flows into atomic n8n workflows: <br>• Workflow A: Ingest & Validate<br>• Workflow B: User Lifecycle<br>• Workflow C: Notification Engine<br>• Workflow D: Data Sync<br>• Workflow E: Admin & Monitoring<br>Each workflow ≤ 10 nodes. Use internal HTTP triggers to chain them.                                                                                                                                            | Trigger end-to-end scenario → each small workflow runs independently, failure in one does not block others.                    | System remains operational even if one module fails. No more “all-in-one” flows.                                                    | Automation Lead    |            |            | Not Started  |
| T09     | P1       | Data Storage Mapping        | Standardise database & sheet access                 | Replace all direct Google Sheets writes with MongoDB/Supabase writes via `/services/storage.js`. Keep Sheets only for legacy reporting (read-only service account). All lookups/updates use `_id` or `internal_event_id`. Add “create if not exists” logic with proper upsert.                                                                                                                                   | Existing record → update. New record → insert. No duplicate rows.                                                               | No more inconsistent column mappings or personal sheet access.                                                                      | Backend + Data Eng |            |            | Not Started  |
| T10     | P1       | Notification Delivery       | Normalise SMS, Email & Slack sending                | Centralise all outgoing messages via `/services/messaging.js`. Enforce E.164 formatting, template rendering, and fallback (SMS fail → email). Remove all direct Twilio/Slack/Gmail nodes from flows.                                                                                                                                                                                                                                                    | Send message → correct channel delivers, fallbacks work, no placeholder text.                                                  | Single source of truth for all outbound communication. No scattered notification nodes.                                              | Integration Eng    |            |            | Not Started  |
| T11     | P1       | Temporary Code Security    | Move short-lived token logic server-side           | Any OTP, magic link, or short-lived code generation/validation moved to dedicated `/otp/*` endpoints with hashed storage and 10-min TTL + rate limiting (3 attempts). Logs never contain raw codes.                                                                                                                                                                                                                                                      | Generate → verify within window → success. Expired or too many attempts → fail.                                                | No ephemeral secrets handled client-side or in workflow memory.                                                                     | Backend Lead       |            |            | Not Started  |
| T12     | P1       | Email Domain & Deliverability | Switch to verified company domain                  | All customer-facing emails must originate from `no-reply@yourcompany.com` (or similar). Configure SPF, DKIM, DMARC. Replace Gmail nodes with SendGrid/Mailgun or SES wrapper in `/services/messaging.js`.                                                                                                                                                                                                                                                      | Send test email → passes spam checks, lands in inbox, correct Reply-To.                                                         | Zero emails from personal/test domains in production.                                                                               | DevOps + Marketing |            |            | Not Started  |
| T13     | P2       | Monitoring & SLA            | Add health checks and alerting dashboard            | Deploy `/health`, `/metrics` endpoints. Set up Slack + email alerts if error rate > 2% in 5 min or > 10 failed jobs/hour. Add daily summary report.                                                                                                                                                                                                                                                                                                   | Simulate failures → alerts fire correctly. Daily summary delivered.                                                            | Team knows within minutes if anything breaks.                                                                                        | DevOps             |            |            | Not Started  |
| T14     | P2       | Documentation & Handoff     | Deliver complete developer spec & runbook           | Produce `SYSTEM_SPEC.md` containing: architecture diagram, list of all internal endpoints, event catalog, payload examples, rollback steps, vault variable list, Postman collection, n8n flow export instructions.                                                                                                                                                                                                                                  | New developer can deploy and understand full system in < 4 hours using only this doc.                                           | Single source of truth accepted and version-controlled.                                                                             | Tech Lead          |            |            | Not Started  |
| T15     | P2       | Clean Up Test Artifacts     | Remove all test/debug data and accounts             | Search and destroy any leftover test emails, phone numbers, Slack channels, placeholder text. Ensure production flows contain zero references to `sandytest42`, `+61411111111`, etc.                                                                                                                                                                                                                                                                   | Run production flow → no test data appears anywhere.                                                                           | Production environment 100% clean.                                                                                                  | QA + DevOps        |            |            | Not Started  |
Task ID,Priority,Module,Title,Detailed Action,Acceptance Criteria
Pleae note;
1; Project Setup,Security & Secrets First,"Before writing any code: create vault/.env template with all secrets (HMAC_SECRET, TWILIO_, SENDGRID_, MONGO_URI, etc.). Never commit real secrets.",Repo contains .env.example only; no secrets in git
2;,Add Future Verification Gate,Leave a placeholder endpoint /verify/entitlement that currently returns { allowed: true }. All money/user-credit actions must call this before proceeding.,Future-proof for adding manual approval or extra checks without changing architecture